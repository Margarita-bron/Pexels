import { useLocation } from 'react-router-dom';
import '../../styles/index';
import { SearchBar } from '../SearchBar/SearchBar';
import { useEffect, useState } from 'react';
import { useNavigate } from 'react-router';

export const Header: React.FC<{
  search: string;
  setSearch: React.Dispatch<React.SetStateAction<string>>;
}> = ({ search, setSearch }) => {
  const location = useLocation();
  const isSearchPage = location.pathname.startsWith('/search');
  const navigate = useNavigate();

  const [isFixed, setIsFixed] = useState(false);

  useEffect(() => {
    const handleScroll = (): void => {
      if (window.scrollY > window.innerHeight) {
        setIsFixed(true);
      } else {
        setIsFixed(false);
      }
    };

    window.addEventListener('scroll', handleScroll);

    return (): void => {
      window.removeEventListener('scroll', handleScroll);
    };
  }, []);

  const handleNavigate = (): void => {
    setSearch('');
    void navigate('/');
  };

  return (
    <div
      className={`header-navbar ${isSearchPage ? ' header-navbar_position-relative black-color ' : 'white-color'}${isFixed ? ' header_fixed' : ''}`}
    >
      <div onClick={handleNavigate}>
        <svg
          width="85"
          height="38"
          className={`navbar-logo element__margin-right-30 white-color${isSearchPage ? ' black-color ' : ' white-color '}`}
          viewBox="0 0 512 227"
        >
          <path d="M511.187 131.02C509.164 120.486 506.384 114.524 503.211 107.417C501.187 102.884 499.317 98.6027 498.694 95.7914C497.152 88.8342 497.908 80.1165 498.265 76.9559H479.596L476.451 81.9607C469.281 93.3721 453.608 118.338 453.607 118.339C444.924 131.386 434.121 147.618 418.553 153.758C415.613 154.751 409.393 156.767 404.469 151.122C399.777 145.744 400.185 139.937 400.204 139.692L400.223 139.433L400.235 139.275L400.351 139.165L400.543 138.982C421.115 119.456 440.747 98.0267 450.557 84.3877C461.856 68.6797 467.522 55.7517 471.946 44.8671C474.701 38.0835 480.429 21.0609 474.129 9.53638C471.495 4.71716 467.034 1.44608 461.567 0.325525C460.497 0.106481 459.471 0 458.432 0C446.837 0 433.098 14.565 416.43 44.5274C402.557 69.4604 392.695 90.8751 387.12 108.177C384.235 117.129 382.339 128.47 382.339 128.471C381.714 129.595 370.375 142.671 359.178 150.087C355.43 152.569 349.908 155.638 342.002 155.638C334.841 155.638 328.199 151.258 328.197 151.257C328.2 151.256 339.703 145.052 358.243 126.848C368.262 117.009 372.497 103.566 369.295 91.7638C364.27 73.2637 346.588 71.826 341.288 71.826C326.515 71.8713 314.504 81.4527 308.708 89.6434C294.733 109.381 295.344 125.544 297.439 137.419C298.118 141.257 299.355 145.038 301.115 148.654L301.29 149.012C301.288 149.013 279.271 164.432 266.053 146.596C260.98 139.75 253.158 125.537 253.157 125.534L299.238 76.9613H274.472C258.72 93.2817 243.999 108.701 243.996 108.704C243.995 108.701 233.145 87.9123 227.999 76.9559H207.991C209.743 80.4129 211.508 83.9821 213.435 87.8768C219.788 100.719 230.978 122.349 230.979 122.351C230.978 122.353 226.203 127.339 226.202 127.341C223.675 129.967 215.982 137.958 203.609 145.553C196.697 149.788 189.441 152.685 181.427 154.409C175.157 155.759 167.083 155.908 162.222 154.604C159.442 153.858 154.206 151.303 154.206 151.303C154.208 151.301 168.684 142.237 184.317 126.858C194.327 117.011 198.563 103.568 195.371 91.7732C190.344 73.2768 172.662 71.8395 167.362 71.8395C152.593 71.8845 140.578 81.4614 134.777 89.6491C120.804 109.375 121.416 125.547 123.511 137.432C124.127 140.925 126.491 147.497 126.491 147.497C115.785 153.142 105.638 156.512 93.2508 156.956C92.1763 156.995 87.5926 157.012 86.1204 156.934C85.7569 156.915 84.623 156.763 84.623 156.763C84.6237 156.763 87.2107 155.105 87.8157 154.692C103.092 144.267 109.834 125.528 110.298 108.996C110.682 95.3566 107.46 84.338 101.226 77.974C97.3124 73.9742 92.1345 71.9054 85.8352 71.826H85.5688C74.4682 71.826 61.8243 78.4821 53.018 86.7525C50.955 88.6901 45.1151 95.26 45.1149 95.2603L48.7384 76.9532H29.566L0 226.271H19.1834L36.48 138.885C40.2234 122.447 45.9629 112.029 56.9644 101.665L57.1455 101.51C59.8693 99.1994 62.9849 97.0036 65.918 95.328C70.7655 92.5572 75.1511 91.152 78.9529 91.152C81.208 91.152 83.2428 91.6543 85.0023 92.6447C91.2279 96.1683 91.9858 104.727 92.3933 109.326C93.9896 127.445 80.0006 139.727 78.4002 141.068C73.7991 144.917 68.9992 146.788 63.7256 146.788C56.6649 146.788 51.3729 144.284 48.4039 142.896C48.2907 143.445 47.5469 147.095 47.5469 147.095C46.8113 150.765 45.389 158.138 45.3888 158.139C53.0786 164.721 68.412 172.104 88.6396 173.266C90.28 173.362 91.9431 173.41 93.5821 173.41C108.447 173.41 123.012 169.522 136.873 161.854L137.135 161.71L137.36 161.904C142.623 166.436 147.692 168.647 149.358 169.373C159.042 173.596 169.583 173.335 170.617 173.335C183.411 173.335 195.361 169.647 198.718 168.517C219.995 161.354 232.065 147.959 236.609 142.977L240.074 139.324L242.274 143.381C245.181 148.764 248.476 154.865 254.285 161.506C256.697 164.264 265.809 173.26 281.817 173.26C297.013 173.26 312.644 162.989 312.645 162.988C312.648 162.991 317.775 167.024 323.309 169.632C330.243 172.899 338.323 173.252 341.475 173.252C357.227 173.252 370.233 167.39 383.645 154.243L384.105 153.792C384.106 153.794 386.055 158.429 387.734 160.845C396.363 173.254 407.477 173.294 411.374 173.294C414.976 173.294 421.025 172.67 425.577 170.911C445.916 163.047 461.71 141.167 469.314 128.825C469.315 128.823 475.112 119.634 481.964 105.539L483.494 102.455C483.495 102.456 487.147 111.122 487.148 111.125C489.25 116.226 491.21 121.908 492.143 125.6C494.718 135.576 496.443 144.345 491.431 150.591C488.987 153.607 483.95 156.851 478.666 156.851C475.899 156.851 473.29 155.986 470.912 154.279C470.011 153.616 469.077 152.78 468.125 151.79C464.24 156.638 460.211 161.063 456.139 164.956C459.638 167.489 467.811 173.453 480.048 173.453C483.773 173.453 489.075 172.493 492.539 170.772C506.635 163.769 514.679 149.203 511.187 131.02ZM408.648 103.39L410.031 99.942C415.213 87.0267 422.71 71.8007 432.95 53.394C444.791 32.107 452.665 23.6148 456.304 20.4475L457.405 19.4904L458.066 18.9154L458.107 19.782L458.176 21.2241C458.376 25.5125 456.987 31.7896 454.461 38.0155C450.253 48.3681 445.298 59.6522 435.181 73.718C430.12 80.7499 421.854 90.4729 411.905 101.095L409.353 103.823L407.815 105.467L408.648 103.39ZM145.307 136.878L144.861 137.202C144.861 137.202 144.221 135.9 143.86 134.868C142.402 130.693 141.92 123.862 142.646 118.327C143.928 108.754 148.185 102.304 149.957 99.9748C155.245 93.023 161.306 89.2002 166.955 88.538C168.919 88.3079 172.297 88.586 175.232 91.4015C177.994 94.0512 182.867 103.41 172.359 114.719C169.155 118.165 166.306 120.924 159.623 126.442C154.621 130.592 146.82 135.864 145.307 136.878ZM318.664 137.054L318.177 137.379L318.019 136.821L317.469 134.87C315.935 129.43 315.528 123.861 316.26 118.32C317.524 108.782 321.793 102.31 323.569 99.97C328.853 93.0179 334.89 88.9582 340.567 88.5394C340.936 88.5117 341.323 88.4931 341.723 88.4931C344.486 88.4931 346.816 89.4416 348.844 91.3926C351.605 94.0512 356.469 103.424 345.959 114.718C342.751 118.167 339.902 120.927 333.237 126.446C327.744 130.994 318.754 136.994 318.664 137.054Z"></path>
        </svg>
      </div>

      {(isSearchPage || isFixed) && (
        <SearchBar search={search} setSearch={setSearch} />
      )}
      <div className="header-navbar_menu">
        <div className="navbar-tooltip">
          <div className="navbar-tooltip-item">
            <a
              data-testid="next-link"
              className="button"
              href="/ru-ru/discover/"
            >
              <span
                className={isSearchPage ? ' black-color ' : ' white-color '}
              >
                Search photos
              </span>
            </a>
            <svg
              data-indicator="true"
              className={isSearchPage ? ' black-color ' : ' white-color '}
              viewBox="0 0 24 24"
              width="24"
              height="24"
            >
              <path d="M15.88 9.29L12 13.17 8.12 9.29c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.39-.39.39-1.02 0-1.41-.39-.38-1.03-.39-1.42 0z"></path>
            </svg>
          </div>
          <div data-tooltip="true" className="tooltip-container">
            <ul className="tooltip-list">
              <li>
                <a data-testid="next-link" className="" href="/ru-ru/discover/">
                  <svg
                    data-indicator="true"
                    className=""
                    viewBox="0 0 24 24"
                    width="24"
                    height="24"
                  >
                    <path d="M21.9997 10.9451h-5.3515c-.0274-.8678-.0764-1.7242-.1705-2.54405-.2039-1.80424-.5544-3.40035-1.0164-4.69791 1.8316.76565 3.3718 2.11384 4.3547 3.84037l1.7384-.98976c-1.2723-2.23477-3.3024-3.96099-5.7166-4.86087-5.6822-2.118227-12.02778.78462-14.14506 6.4679-2.117464 5.68262.78328 12.02882 6.46661 14.14642C9.42057 22.7773 10.7143 23 11.9871 23c.5972 0 1.1888-.0527 1.7713-.1482.0359-.006.0716-.0106.1064-.0204 3.7273-.6489 7.027-3.1975 8.4409-6.9922.4675-1.258.7013-2.5701.6941-3.8991-.0033-.5502-.4499-.995-1.0001-.995Zm-9.0055-7.87875c.6886 1.20326 1.2277 3.18797 1.4964 5.56132.0857.74644.1309 1.52643.1575 2.31743H9.34958c.0265-.7934.07179-1.57434.15755-2.3194.26838-2.37514.80777-4.35927 1.49707-5.55948.6548-.07399 1.3211-.07421 1.99.00013Zm-9.42767 5.7925c.90333-2.42487 2.75071-4.22226 4.96826-5.14967-.4621 1.29703-.81175 2.88929-1.01478 4.68995-.09417.81752-.14305 1.67507-.17044 2.54597H3.05932c.08397-.7045.25334-1.40386.50721-2.08625Zm.24868 6.88265c-.4108-.8985-.66798-1.8414-.7695-2.796h4.30081c.02552.9076.07529 1.8014.17349 2.6528.20365 1.8025.55376 3.3971 1.01621 4.6969-2.09857-.8744-3.77033-2.4745-4.72101-4.5537Zm7.18649 5.1923c-.6879-1.2068-1.22619-3.1908-1.49457-5.5628-.08978-.7782-.13571-1.5954-.16059-2.4255h5.30466c-.0249.8278-.0709 1.6446-.1606 2.4275-.2644 2.3319-.8154 4.3553-1.4964 5.561-.6556.0742-1.3227.0744-1.9925-.0002Zm9.4295-5.792c-.9036 2.4247-2.7511 4.2221-4.9686 5.1495.4614-1.2996.8111-2.893 1.0151-4.6917.0981-.8564.1479-1.7496.1735-2.6541h4.2983c-.0795.7462-.2526 1.4814-.5183 2.1963Z" />
                  </svg>
                  <span>Search for free photos</span>
                </a>
              </li>
              <li>
                <a
                  data-testid="next-link"
                  className=""
                  href="/ru-ru/leaderboard/"
                >
                  <svg
                    data-indicator="true"
                    className=""
                    viewBox="0 0 24 24"
                    width="24"
                    height="24"
                  >
                    <path d="m15.0638 20.2609-1.6503-1.6503 2.6976-2.6977-.3543-1.9864c-.0671-.3758.054-.7607.3237-1.0303l1.4354-1.4354c1.7051-1.7051 2.7947-3.96115 3.0708-6.35527l.0293-.72227-.7223.02931c-2.3947.27614-4.6501 1.36574-6.3558 3.07015l-1.4355 1.43543c-.2689.26963-.6545.39337-1.0296.32369l-1.98646-.35365-1.04726 1.04726 5.31842 5.31835-1.6504 1.6504-6.14355-6.1436c-.4559-.4559-.4559-1.19443 0-1.65032l2.30294-2.30294c.26963-.26963.65584-.39077 1.02968-.32369l1.98643.35365 1.0049-1.00493c2.088-2.08737 4.854-3.41729 7.7881-3.74424.0273-.00325.0547-.00521.082-.00651l2.0281-.08141c.3341-.00586.6415.11072.8721.34127.2305.23056.3543.54643.3413.87207l-.0814 2.0281c-.0013.02735-.0033.05471-.0066.08271-.3269 2.93339-1.6568 5.69874-3.7448 7.78674l-1.005 1.0049.3543 1.9865c.0671.3758-.054.7607-.3237 1.0303l-3.1281 3.1281Zm-7.23444-4.5733-1.65035-1.6504L1 19.2162l1.65035 1.6504 5.17901-5.179Zm3.13264 3.1327-1.65032-1.6504-3.32219 3.3222 1.65035 1.6504 3.32216-3.3222Z"></path>
                    <span>Leaderboard</span>
                  </svg>
                </a>
              </li>
              <li>
                <a
                  data-testid="next-link"
                  className=""
                  href="/ru-ru/challenges/"
                >
                  <svg
                    data-indicator="true"
                    className=""
                    viewBox="0 0 24 24"
                    width="24"
                    height="24"
                  >
                    <path d="M11.5922 10.9431c-.2194 0-.4394-.0664-.6278-.1986L5.46443 6.88152C5.17309 6.67736 5 6.34396 5 5.98803V1h2.18439v4.4206l4.40781 3.09556L16 5.4206V1h2.1844v4.98803c0 .35593-.1731.68933-.4644.89349l-5.5 3.86298c-.1884.1322-.4084.1986-.6278.1986Z" />
                    <path d="M11.5923 23c-3.32411 0-6.0284-2.7043-6.0284-6.0284 0-3.3242 2.70417-6.0285 6.0283-6.0285 3.3241 0 6.0285 2.7043 6.0285 6.0285 0 3.3241-2.7042 6.0284-6.0284 6.0284Zm0-9.8725c-2.11976 0-3.844 1.7243-3.844 3.8441 0 2.1197 1.72424 3.844 3.844 3.844 2.1198 0 3.8441-1.7243 3.8441-3.844 0-2.1198-1.7243-3.8441-3.8441-3.8441Z" />
                    <span>Challenges</span>
                  </svg>
                </a>
              </li>
              <li>
                <a data-testid="next-link" className="" href="/ru-ru/videos/">
                  <svg
                    data-indicator="true"
                    className=""
                    viewBox="0 0 24 24"
                    width="24"
                    height="24"
                  >
                    <path d="M9.85177 17.3545c-.1892 0-.37906-.0469-.55088-.1411-.36879-.2014-.5984-.5881-.5984-1.0082V7.79542c0-.42456.23408-.81482.60926-1.01459.37517-.19913.82925-.17541 1.18135.06093l6.3979 4.30464c.3214.2161.5118.5791.508.9665-.0045.3867-.2027.7452-.5285.9542l-6.3979 4.1052c-.1886.1213-.4047.1822-.62083.1822Z" />
                    <path d="M12.0001 23C5.93442 23 1 18.0655 1 11.9999 1 5.93442 5.93442 1 12.0001 1c2.5763 0 5.082.90909 7.0554 2.55988l-1.4751 1.76303c-1.5603-1.30543-3.5421-2.02437-5.5803-2.02437-4.79776 0-8.70156 3.90348-8.70156 8.70136 0 4.7978 3.9038 8.7015 8.70156 8.7015 4.7979 0 8.7017-3.9037 8.7017-8.7015 0-1.0621-.1892-2.09914-.5618-3.08298l2.1497-.81444c.4714 1.24483.7106 2.55632.7106 3.89742C23.0003 18.0655 18.0659 23 12.0001 23Z" />
                    <span>Free videos</span>
                  </svg>
                </a>
              </li>
              <li>
                <a data-testid="next-link" className="" href="/ru-ru/blog/">
                  <svg
                    data-indicator="true"
                    className=""
                    viewBox="0 0 24 24"
                    width="24"
                    height="24"
                  >
                    <path d="M21.8507 23H2.14925C1.51434 23 1 22.4857 1 21.8507V2.14926C1 1.51435 1.51434 1 2.14925 1H21.8507C22.4857 1 23 1.51435 23 2.14926v5.55836c0 .63492-.5143 1.14924-1.1493 1.14924H5.92537V6.55837H20.7015V3.29851H3.29851V20.7015H20.7015v-9.0459H23v10.1951C23 22.4857 22.4857 23 21.8507 23Z"></path>
                    <span>Pexels Blog</span>
                  </svg>
                </a>
              </li>
            </ul>
          </div>
        </div>

        <a
          data-testid="next-link"
          className="button text__color-white"
          href="/ru-ru/license/"
        >
          <span className={isSearchPage ? ' black-color ' : ' white-color '}>
            License
          </span>
        </a>

        <div>
          <button className="button clicable-icon navbar-more">
            <svg
              width="24"
              height="24"
              className={isSearchPage ? ' black-color ' : ' white-color '}
              viewBox="0 0 24 24"
            >
              <path d="M5.93103 13.8621c1.06649 0 1.93104-.8646 1.93104-1.9311 0-1.0664-.86455-1.931-1.93104-1.931C4.86455 10 4 10.8646 4 11.931c0 1.0665.86455 1.9311 1.93103 1.9311Zm6.06897 0c1.0665 0 1.931-.8646 1.931-1.9311C13.931 10.8646 13.0665 10 12 10s-1.931.8646-1.931 1.931c0 1.0665.8645 1.9311 1.931 1.9311Zm6.069 0c1.0664 0 1.931-.8646 1.931-1.9311C20 10.8646 19.1354 10 18.069 10c-1.0665 0-1.9311.8646-1.9311 1.931 0 1.0665.8646 1.9311 1.9311 1.9311ZZ"></path>
            </svg>
          </button>
        </div>

        <button id="navbar_notification-icon" className="button clicable-icon">
          <svg
            className={isSearchPage ? ' black-color ' : ' white-color '}
            viewBox="0 0 24 24"
            width="24"
            height="24"
          >
            <path d="M11.8835 23c-2.01444 0-3.71459-1.3685-4.2206-3.2246H3.14926C2.51434 19.7754 2 19.2611 2 18.6262v-2.3248c0-.3739.18213-.7247.48805-.9402l1.94835-1.3698V8.44708C4.4364 4.34066 7.77706 1 11.8835 1c4.1102 0 7.4541 3.34066 7.4541 7.44708V13.992l1.9426 1.3704c.3053.2149.4868.5657.4868.939v3.474h-2.2985v-2.8782l-1.9426-1.3705c-.3054-.2149-.4869-.5656-.4869-.9389V8.44708c0-2.83916-2.3125-5.14857-5.1555-5.14857-2.83919 0-5.14859 2.30941-5.14859 5.14857v6.14072c0 .3739-.18214.7247-.48805.9401l-1.94834 1.3699v.5791h4.36037c.63491 0 1.14925.5144 1.14925 1.1493 0 1.1441.93116 2.0753 2.07536 2.0753 1.1441 0 2.0753-.9312 2.0753-2.0753v-1.1493h2.2985v1.1493c0 2.412-1.9618 4.3738-4.3738 4.3738Z"></path>
          </svg>
        </button>

        <a
          id="upload-link"
          data-testid="next-link"
          className="button_white-color button clicable-icon"
          href="/ru-ru/upload/"
        >
          <svg
            className={`upload-link_icon ${isSearchPage ? ' black-color ' : ' white-color '}`}
            viewBox="0 0 24 24"
            width="24"
            height="24"
          >
            <path d="M23 15.1557v6.7194C23 22.4965 22.4857 23 21.8508 23H2.14922C1.51434 23 1 22.4965 1 21.8751v-6.7194h2.29844v5.5944H20.7016v-5.5944H23ZM10.8751 5.30632V18.9504h2.2498V5.30632l5.2995 5.29948 1.5907-1.59074-7.2197-7.21974c.0001.00005-.0001-.00004 0 0L12 1 3.9849 9.01506l1.59073 1.59074 5.29947-5.29948Z" />
          </svg>
        </a>

        <div className="navbar-avatar button">
          <img
            src="https://images.pexels.com/lib/avatars/purple.png?w=50&amp;h=50&amp;fit=crop&amp;dpr=1"
            srcSet="https://images.pexels.com/lib/avatars/purple.png?w=50&amp;h=50&amp;fit=crop&amp;dpr=1 1x, https://images.pexels.com/lib/avatars/purple.png?w=50&amp;h=50&amp;fit=crop&amp;dpr=2 2x"
            alt="user"
            className="avatar-img"
            width="50"
            height="50"
            draggable="false"
          />
        </div>

        <a
          id="loading-link"
          data-testid="next-link"
          className={`${isSearchPage ? ' black-color ' : ' white-color '} button`}
          href="/ru-ru/upload/"
        >
          <span className="">Loading</span>
        </a>

        <button
          className={`${isSearchPage ? ' button_black-color ' : ' button_white-color '}button`}
        >
          <span className="">Registration</span>
        </button>

        <button
          className="button clicable-icon navbar-menu-icon"
          color="white$FFFFFF"
        >
          <span className="navbar-menu-icon_wrapper">
            <span aria-hidden="true" className="navbar-menu-icon_line"></span>
            <span aria-hidden="true" className="navbar-menu-icon_line"></span>
          </span>
        </button>
      </div>
    </div>
  );
};
